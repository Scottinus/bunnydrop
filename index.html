<!DOCTYPE html>
<html>
  <head>
    <title>Lunar Bunny</title>
    <style>
      body {
        background: #1b1b1b;
        overflow: hidden;
        cursor: crosshair;
      }
      img {
        position: absolute;
        width: auto;
        height: 100%;
        left: 50%;
        transform: translate(-50%);
      }
      #layer1 {
        z-index: 0;
      }
      #layer2 {
        z-index: 1;
      }

      #layer3 {
        z-index: 3;
        border: 2px solid #1b1b1b;
        border: 2px solid #1b1b1b;
        box-shadow: #1b1b1b 1px 1px 1px inset;
      }
      #layer3 {
        z-index: 4;
        border: 2px solid #1b1b1b;
        border: 2px solid #1b1b1b;
        box-shadow: #1b1b1b 1px 1px 1px inset;
      }
      button {
        position: absolute;
        top: 15%;
        width: 250px;
        height: 80px;
        z-index: 5;
        left: 50%;
        transform: translate(-50%);
        border-radius: 8px;
        background-color: #fff;
        color: #1b1b1b;
      }

      #container {
        width: 100%;
        height: 100vh;
        position: relative;
        overflow: hidden;
      }
      #container > img {
        transform: translate(-50%) perspective(50em) rotateY(0deg) rotateX(0deg);
      }
    </style>
  </head>
  <body>
    <div id="container">
      <img
        id="layer1"
        width="100%"
        height="auto"
        src="bunnydrop/bg3.png"
        alt="Image 3"
      />
      <img
        id="layer2"
        width="100%"
        height="auto"
        src="./bunnydrop/char3.png"
        alt="Image 1"
      />
      <!--   <div class="rest-frame frame-left"></div> -->
      <img
        id="layer4"
        width="100%"
        height="auto"
        src="bunnydrop/shadowframe.png"
        alt="Image 4"
      />
      <img
        id="layer3"
        width="100%"
        height="auto"
        src="bunnydrop/frame3.png"
        alt="Image 3"
      />
    </div>
    <script type="text/javascript">
      function onDeviceOrientation(event) {
        const btn = document.querySelector("button");
        btn.style.backgroundColor = "green";
        btn.innerText = "enabled";
        console.log("ON DEVICE OREINTATION");
        console.log(`event`, event);
        /*     setCssTransformInverse({
        transform: `rotateX(${b}deg) rotateY(${g}deg) rotateZ(${a}deg)`,
      }); */
        var absolute = event.absolute;
        var alpha = event.alpha;
        // alpha is the inclination on the z-axis

        var beta = event.beta;
        // beta is the inclination on the x-axis

        var gamma = event.gamma;
        // gamma is the inclination on the y-axis

        console.log(beta);
        images.forEach((image, index) => {
          {
            let speed = 2;
            switch (index) {
              case 3:
                speed = 2;
                break;
              case 2:
                speed = 3;
                break;
              default:
                speed = 3.5;
                break;
            }
            const xRotation = () => {
              let rotation = (beta - 90) / (speed * 10);
              return -rotation;
            };
            const xPosition = gamma / (speed * 50);
            const yPosition = beta / (speed * 50);
            image.style.transform = `translate(-50%) perspective(50em) rotateX(${xRotation()}deg) rotateY(${
              gamma / (speed * 10)
            }deg)`;
            image.style.left = `${xPosition + 50}%`;
            image.style.top = `${yPosition}%`;
          }
        });
      }

      function requestOrientationPermission() {
        DeviceOrientationEvent.requestPermission();
      }
      const onClick = async () => {
        window.addEventListener("deviceorientation", onDeviceOrientation, true);
      };
    </script>
    <button onclick="onClick();">Enable Permission</button>

    <script type="application/javascript" src="desktopdynamic.js"></script>
    <script type="application/javascript" src="mobiledynamic.js"></script>
  </body>
</html>
